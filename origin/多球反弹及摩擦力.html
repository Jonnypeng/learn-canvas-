<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>多球反弹</title>
	<style>
	body {
		margin: 0px;
	}
	</style>
	<script src="//cdn.bootcss.com/modernizr/2010.07.06dev/modernizr.min.js"></script>
	<script type="text/javascript">
	window.addEventListener("load", eventWindowLoaded, false);

	function eventWindowLoaded() {
		canvasApp();
	};

	function canvasApp() {
		if (!canvasSupport) {
			return;
		};

		var balls = new Array();
		var numBalls = 200;
		var maxSize = 15;
		var minSize = 5;
		var maxSpeed = maxSize + 5;
		var tempBall;
		var tempX;
		var tempY;
		var tempAngle;
		var tempRadius;
		var tempRadians;
		var tempvelocityx;
		var tempvelocityy;

		var theCanvas = document.getElementById("canvasOne");
		var context = theCanvas.getContext("2d");

		for (var i = 0; i < numBalls; i++) {
			tempRadius = 5;
			var placeOK = false;
			while(!placeOK){
				tempX = tempRadius*3 + (Math.floor(Math.random()*theCanvas.width) - tempRadius*3;
				tempY = tempRadius*3 + (Math.floor(Math.random()*theCanvas.height) - tempRadius*3;
				tempSpeed = 4;
				tempAngle = Math.floor(Math.random()*360);
				tempRadians = tempAngle*Math.PI/180;
				tempvelocityx = cos(tempRadians)*tempSpeed;
				tempvelocityy = cos(tempRadians)*tempSpeed;

				tempBall = {x:tempX,y:tempY,nextX:tempX,nextY:tempY,radius:tempRadius,speed:tempSpeed,angle:tempAngle,veolocityx:tempvelocityx,velocityy:tempvelocityy,mass:tempRadius};
				placeOK = canStartHere(tempBall);
			};
			balls.push(tempBall);
		};

		function canStartHere(ball){
			var retval = true;
			for(var i =0; i<balls.length;i++){
				if(hitTestCircle(ball,balls[i])){
					retval = false;
				};
			};
			return retval;
		};

		function hittestCircle(ball1.ball2){
			var retval = false;
			var dx = ball1.nextx - ball2.nextx;
			var dy = ball1.nexty - ball2.nexty;
			var distance = (dx*dx + dy*dy);
			if(distance<=(ball1.radius+ball2.radius)*(ball1.radius+ball2.radius)){
				retval = true;
			};
			return retval;
		};

	};
	</script>
	</head>

	<body>
	<div style="position: aballs[j]olute; top: 50px; left: 50px;">
	<canvas id="canvasOne">
	Your browser does not support the HTML 5 Canvas.
	</canvas>
	</div>
	</body>

	</html>
